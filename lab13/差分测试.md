### 差分测试（Differential Testing）

#### 1.基本原理（Differential Testing for Software）

差分测试是随机测试的⼀种形式。差分测试解决了⼀个特定的问题：评估测试结果的成本。每次测试都会产生一些结果。如果将⼀个测试提供给几个可比较的程序（例如几个c编译器），而⼀个程序给出不同的结果，则报错。

对于可行的软件，生成的测试很少会产生差异。因为生成数百万个测试是很容易的，所以即使是一些差异也可能导致大量检测到的错误。

#### 2.差分测试的四个问题

第一个问题涉及测试的质量。任何提供给 C 编译器的随机字符串都会产生一些结果——很可能是诊断结果。然而，向编译器提供随机字符串很快就会变得无效，因为这些测试只提供编译器逻辑的浅层覆盖。开发人员必须设计能够深入测试编译器的测试。

第二个问题与误报有关。两个测试程序的结果可能不同，但仍然是正确的，具体取决于要求。例如，C 编译器可以自由地在 C 标准中详述的未指定、未定义或实现定义的构造的替代方案中进行选择。3 同样，即使对于必需的诊断，诊断的形式也是未指定的，因此难以跨系统进行比较。

第三个问题处理生成的测试用例中的噪声量。给定一个成功的随机测试，可能会有一个更短的测试暴露相同的错误。

第四个问题涉及比较必须在不同平台上运行的程序。

因此为执行高效的差分测试，需要不断提高测试程序的质量。

#### 3.主要应用

差分测试，补充了传统的软件测试过程，具有很大的成本效益，广泛适用于大型软件。

差异测试可用于增加测试覆盖率。使用从运行标准回归套件中获取的覆盖率数据作为基线，开发人员可以运行随机测试以查看是否可以增加覆盖率。开发人员可以使用测试输出作为初始预言，自由地向测试套件添加覆盖率增加的测试。不会造成任何损害，因为即使记录的结果是错误的，编译器也不会因此而变得更糟。如果稍后在生成的测试中观察到回归，则新版本或旧版本都是错误的。开发人员会收到警报并做出反应。 

差异测试可以比较新旧结果，标记与旧结果不一致的所有新结果（正确与否）。

差异测试可用于衡量质量。假设多数规则，一百万个测试可以在一组竞争编译器上运行。该指标是每百万次运行失败的测试。失败编译器的作者可以修复错误或证明大多数错误。在任何情况下，质量都会提高。

**Feedback-Directed Differential Testing of Interactive Debuggers**

通过交互式差分测试解决了在两个调试器之间发现不同行为的问题。 基本思想是通过不断生成调试操作并检查结果行为是否存在不一致来比较两个假定等效的调试器。